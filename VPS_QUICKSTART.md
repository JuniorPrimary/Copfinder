# üöÄ –ë—ã—Å—Ç—Ä–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ VPS

–ü—Ä–æ–µ–∫—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç AWS** –∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ª—é–±–æ–º Linux VPS. –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–π–º–µ—Ç **15-30 –º–∏–Ω—É—Ç**.

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞ VPS

- **OS**: Ubuntu 20.04+ / Debian 11+ / CentOS 8+ / Amazon Linux 2
- **RAM**: –ú–∏–Ω–∏–º—É–º 2GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4GB)
- **CPU**: 2 —è–¥—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **Storage**: 20GB+ SSD
- **Node.js**: 18+ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS

```bash
ssh root@YOUR_VPS_IP
# –∏–ª–∏
ssh user@YOUR_VPS_IP
```

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### –î–ª—è Ubuntu/Debian:
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt-get update && sudo apt-get upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 20.x
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git
sudo apt-get install -y git

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Playwright
sudo apt-get install -y \
  libnss3 \
  libnspr4 \
  libatk1.0-0 \
  libatk-bridge2.0-0 \
  libcups2 \
  libdrm2 \
  libxkbcommon0 \
  libxcomposite1 \
  libxdamage1 \
  libxfixes3 \
  libxrandr2 \
  libgbm1 \
  libasound2 \
  libpango-1.0-0 \
  libcairo2 \
  libatspi2.0-0 \
  libxshmfence1
```

#### –î–ª—è CentOS/RHEL/Amazon Linux:
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo yum update -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 20.x
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -
sudo yum install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git
sudo yum install -y git

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Playwright
sudo yum install -y \
  nss \
  atk \
  at-spi2-atk \
  cups-libs \
  gtk3 \
  libXcomposite \
  libXcursor \
  libXdamage \
  libXext \
  libXi \
  libXrandr \
  libXScrnSaver \
  libXtst \
  pango \
  xorg-x11-server-Xvfb
```

### –®–∞–≥ 3: –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Redis

```bash
cd /opt

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/JuniorPrimary/Copfinder.git copfinder
cd copfinder

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Redis
chmod +x scripts/setup-redis.sh
sudo ./scripts/setup-redis.sh
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç

```bash
cd /opt/copfinder

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js
npm install --production

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä—ã –¥–ª—è Playwright
npx playwright install --with-deps chromium

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env
cp config/env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã Telegram
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
COPART_TELEGRAM_BOT_TOKEN=your-copart-bot-token
COPART_TELEGRAM_CHAT_ID=your-copart-chat-id
TELEGRAM_BOT_TOKEN=your-iaai-bot-token
TELEGRAM_CHAT_ID=your-iaai-chat-id

# Redis (–æ–±—ã—á–Ω–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TTL_DAYS=7
```

### –®–∞–≥ 6: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ PM2
npm run pm2:start

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
npm run pm2:status

# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
npm run pm2:logs

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2 (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ)
pm2 save
pm2 startup  # –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ
```

### –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ PM2

```bash
# PM2 –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –∫–æ–º–∞–Ω–¥—É, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –µ—ë (–ø—Ä–∏–º–µ—Ä):
sudo env PATH=$PATH:/usr/bin pm2 startup systemd -u your_user --hp /home/your_user
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ AWS:

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Redis –Ω–∞ AWS:
```bash
# –ù–∞ AWS —Å–µ—Ä–≤–µ—Ä–µ
redis-cli --rdb /tmp/dump.rdb
```

### –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ VPS:
```bash
# –ù–∞ VPS
scp user@aws-server:/tmp/dump.rdb /tmp/
sudo systemctl stop redis
sudo cp /tmp/dump.rdb /var/lib/redis/dump.rdb  # –ü—É—Ç—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
sudo chown redis:redis /var/lib/redis/dump.rdb
sudo systemctl start redis
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis
redis-cli ping  # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å PONG
```

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run pm2:restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
npm run pm2:stop

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
npm run pm2:logs

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –≤ Redis
node scripts/get-redis-data.js
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
free -h

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU
top

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –õ–æ–≥–∏ PM2
pm2 logs --lines 100
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall:**
```bash
# Ubuntu/Debian
sudo ufw allow 22/tcp
sudo ufw enable

# CentOS/RHEL
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --reload
```

2. **–û—Ç–∫–ª—é—á–∏—Ç–µ –ø–∞—Ä–æ–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é SSH** (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏)

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É:**
```bash
# Ubuntu/Debian
sudo apt-get update && sudo apt-get upgrade -y

# CentOS/RHEL
sudo yum update -y
```

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **VPS —Å 4GB RAM, 2 CPU, 30GB SSD**: ~$10-15/–º–µ—Å—è—Ü
- **VPS —Å 2GB RAM, 2 CPU, 30GB SSD**: ~$5-10/–º–µ—Å—è—Ü (–º–∏–Ω–∏–º—É–º)

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Playwright –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npx playwright install --with-deps chromium
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏
- –£–º–µ–Ω—å—à–∏—Ç–µ `max_memory_restart` –≤ `ecosystem.config.cjs` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 512M)
- –ò–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ RAM –Ω–∞ VPS

### –ü—Ä–æ–±–ª–µ–º–∞: Redis –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo systemctl status redis

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
sudo journalctl -u redis -n 50
```

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ Redis
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

---

**–ì–æ—Ç–æ–≤–æ!** –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ VPS. üéâ
