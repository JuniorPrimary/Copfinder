# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ AWS EC2

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:

```bash
cd /Users/ff/Desktop/Copfinder
./aws/test-connection.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –ù–∞–ª–∏—á–∏–µ SSH –∫–ª—é—á–∞
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª—é—á—É
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å IP –∞–¥—Ä–µ—Å–∞
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ 22
- ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

---

## üîç –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Permission denied (publickey)"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SSH –∫–ª—é—á –∏–ª–∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ –∫–ª—é—á—É
ls -la ~/.ssh/copfinder-key.pem

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ (400)
chmod 400 ~/.ssh/copfinder-key.pem

# 3. –ï—Å–ª–∏ –∫–ª—é—á –≤ Downloads, –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ
mv ~/Downloads/copfinder-key.pem ~/.ssh/copfinder-key.pem
chmod 400 ~/.ssh/copfinder-key.pem
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Connection timed out" –∏–ª–∏ "Connection refused"

**–ü—Ä–∏—á–∏–Ω–∞:** Security Group –Ω–µ –æ—Ç–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Security Group –≤ AWS Console:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ EC2 ‚Üí Security Groups
   - –ù–∞–π–¥–∏—Ç–µ –≤–∞—à Security Group
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 22 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤–∞—à–µ–≥–æ IP
   - –ï—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ:
     - Type: SSH
     - Port: 22
     - Source: My IP (–∏–ª–∏ –≤–∞—à IP –∞–¥—Ä–µ—Å)

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç–∞–Ω—Å–∞:**
   - –ò–Ω—Å—Ç–∞–Ω—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ "Running"
   - –ï—Å–ª–∏ "Stopped" - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å IP:**
   ```bash
   # –í AWS Console –Ω–∞–π–¥–∏—Ç–µ Public IPv4 address
   # –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
   export AWS_PUBLIC_IP="–≤–∞—à-ip-–∞–¥—Ä–µ—Å"
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Host key verification failed"

**–ü—Ä–∏—á–∏–Ω–∞:** –ò–∑–º–µ–Ω–∏–ª—Å—è –∫–ª—é—á —Ö–æ—Å—Ç–∞ (–æ–±—ã—á–Ω–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Å—Ç–∞–Ω—Å–∞)

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –∫–ª—é—á –∏–∑ known_hosts
ssh-keygen -R –≤–∞—à-ip-–∞–¥—Ä–µ—Å

# –ò–ª–∏ —É–¥–∞–ª–∏—Ç–µ –≤—Å—é —Å—Ç—Ä–æ–∫—É —Å IP –∏–∑ ~/.ssh/known_hosts
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "AWS CLI: UnauthorizedOperation"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ IAM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å EC2

**–†–µ—à–µ–Ω–∏–µ:**

**–í–∞—Ä–∏–∞–Ω—Ç 1: –£–∫–∞–∑–∞—Ç—å IP –Ω–∞–ø—Ä—è–º—É—é (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ)**
```bash
# –ü–æ–ª—É—á–∏—Ç–µ IP –∏–∑ AWS Console (EC2 ‚Üí Instances ‚Üí Public IPv4)
export AWS_PUBLIC_IP="54.235.6.145"  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à IP
export AWS_SSH_KEY="~/.ssh/copfinder-key.pem"
export AWS_SSH_USER="ec2-user"  # –∏–ª–∏ "ubuntu" –¥–ª—è Ubuntu
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ IAM**
- –°–º. [IAM_PERMISSIONS_FIX.md](IAM_PERMISSIONS_FIX.md)

---

### –ü—Ä–æ–±–ª–µ–º–∞ 5: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –î–ª—è Amazon Linux 2023:
export AWS_SSH_USER="ec2-user"

# –î–ª—è Ubuntu Server:
export AWS_SSH_USER="ubuntu"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ AWS Console –∫–∞–∫–æ–π –æ–±—Ä–∞–∑ –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏
```

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
echo "IP: $AWS_PUBLIC_IP"
echo "Key: $AWS_SSH_KEY"
echo "User: $AWS_SSH_USER"
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
```bash
export AWS_PUBLIC_IP="–≤–∞—à-ip-–∏–∑-aws-console"
export AWS_SSH_KEY="~/.ssh/copfinder-key.pem"
export AWS_SSH_USER="ec2-user"
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –∫–ª—é—á
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
ls -la ~/.ssh/copfinder-key.pem

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 400)
stat -f "%OLp" ~/.ssh/copfinder-key.pem  # Mac
# –∏–ª–∏
stat -c "%a" ~/.ssh/copfinder-key.pem   # Linux
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å–∞
```bash
# –í AWS Console:
# 1. EC2 ‚Üí Instances
# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "Running")
# 3. –ó–∞–ø–∏—à–∏—Ç–µ Public IPv4 address
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Security Group
```bash
# –í AWS Console:
# 1. EC2 ‚Üí Security Groups
# 2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à Security Group
# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Inbound rules:
#    - Type: SSH
#    - Port: 22
#    - Source: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞—à IP –∏–ª–∏ "My IP"
```

### –®–∞–≥ 5: –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é
ssh -i ~/.ssh/copfinder-key.pem ec2-user@–≤–∞—à-ip-–∞–¥—Ä–µ—Å

# –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—Ç–ª–∏—á–Ω–æ!
# –ï—Å–ª–∏ –Ω–µ—Ç - —Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫—É –≤—ã—à–µ
```

---

## üõ†Ô∏è –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–æ–ª—É—á–∏—Ç—å IP –∏–∑ AWS Console –≤—Ä—É—á–Ω—É—é:
1. –û—Ç–∫—Ä–æ–π—Ç–µ [EC2 Console](https://console.aws.amazon.com/ec2/)
2. –í—ã–±–µ—Ä–∏—Ç–µ **Instances**
3. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –∏–Ω—Å—Ç–∞–Ω—Å
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Public IPv4 address**

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```bash
export AWS_PUBLIC_IP="54.235.6.145"  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à IP
export AWS_SSH_KEY="~/.ssh/copfinder-key.pem"
export AWS_SSH_USER="ec2-user"
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:
```bash
cd /Users/ff/Desktop/Copfinder
./aws/test-connection.sh
```

### –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é:
```bash
ssh -i ~/.ssh/copfinder-key.pem ec2-user@$AWS_PUBLIC_IP
```

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ AWS:**
   - EC2 ‚Üí Instances ‚Üí –≤–∞—à –∏–Ω—Å—Ç–∞–Ω—Å ‚Üí Monitoring
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ System log –∏ Instance screenshot

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
   - [EC2_SETUP.md](EC2_SETUP.md) - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
   - [AWS_CONSOLE_SETUP.md](AWS_CONSOLE_SETUP.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç—å:**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞
   nc -zv –≤–∞—à-ip 22
   
   # –ò–ª–∏
   telnet –≤–∞—à-ip 22
   ```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

- [ ] SSH –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `~/.ssh/copfinder-key.pem`
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: `chmod 400 ~/.ssh/copfinder-key.pem`
- [ ] IP –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω –∏–∑ AWS Console
- [ ] –ò–Ω—Å—Ç–∞–Ω—Å –≤ —Å—Ç–∞—Ç—É—Å–µ "Running"
- [ ] Security Group –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –ø–æ—Ä—Ç–∞ 22 (–≤–∞—à IP)
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (ec2-user –∏–ª–∏ ubuntu)
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

---

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
./aws/ec2-deploy.sh
```

